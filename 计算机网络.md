## TCP 三次握手和四次挥手、状态转换  
* [博客：TCP协议中的疑难杂症](https://blog.csdn.net/tengxy_cloud/article/details/52329141)  
![](https://github.com/desiress/Learn-Notes/blob/master/docs/image/TCP%E7%8A%B6%E6%80%81%E8%A3%85%E6%8D%A2.jpg)
* 为什么要有三次握手和四次挥手  
* 为什么主动断开连接的一方要进行TIME_WAIT  
据TCP协议规范，不对ACK进行ACK，如果主动关闭方不进入TIME_WAIT，那么主动关闭方在发送完ACK就走了的话，如果最后发送的ACK在路由过程中丢掉了，最后没能到被动关闭方，这个时候被动关闭方没收到自己FIN的ACK就不能关闭连接，接着被动关闭方会超时重发FIN包，但是这个时候已经没有对端会给该FIN回ACK，被动关闭方就无法正常关闭连接了，所以主动关闭方需要进入TIME_WAIT以便能够重发丢掉的被动关闭方FIN的ACK。  


## 在浏览器中www.baidu.com后执行的全部过程

答：1、客户端浏览器通过 DNS 解析到 www.baidu.com 的 IP 地址 220.181.27.48，通过这个 IP 地址找到客户端到服务器的路径。客户端浏览器发起一个 HTTP 会话到 220.181.27.48，然后通过 TCP 进行封装数据包，输入到网络层。  
2、在客户端的传输层，把 HTTP 会话请求分成报文段，添加源和目的端口，如服务器使用 80 端口监听客户端的请求，客户端由系统随机选择一个端口如 5000，与服务器进行交换，服务器把相应的请求返回给客户端的 5000 端口。然后使用 IP 层的 IP 地址查找目的端。  
3、客户端的网络层不用关心应用层或者传输层的东西，主要做的是通过查找路由表确定如何到达服务器，期间可能经过多个路由器，这些都是由路由器来完成的工作，我不作过多的描述，无非就是通过查找路由表决定通过那个路径到达服务器。  
4、客户端的链路层，包通过链路层发送到路由器，通过邻居协议查找给定 IP 地址的 MAC 地址，然后发送 ARP 请求查找目的地址，如果得到回应后就可以使用 ARP 的请求应答交换的 IP 数据包现在就可以传输了，然后发送 IP 数据包到达服务器的地址。  

## TCP 和 UDP 的区别？

答：TCP 提供面向连接的、可靠的数据流传输，而 UDP 提供的是非面向连接的、不可靠的数据流传输。  
TCP 传输单位称为 TCP 报文段，UDP 传输单位称为用户数据报。  
TCP 注重数据安全性，UDP 数据传输快，因为不需要连接等待，少了许多操作，但是其安全性却一般。  
TCP 对应的协议和 UDP 对应的协议  
TCP 对应的协议：  
（1） FTP：定义了文件传输协议，使用 21 端口。  
（2） Telnet：一种用于远程登陆的端口，使用 23 端口，用户可以以自己的身份远程连接到计算机上，可提供基于 DOS 模式下的通信服务。  
（3） SMTP：邮件传送协议，用于发送邮件。服务器开放的是 25 号端口。  
（4） POP3：它是和 SMTP 对应，POP3 用于接收邮件。POP3 协议所用的是 110 端口。  
（5）HTTP：是从 Web 服务器传输超文本到本地浏览器的传送协议。  
UDP 对应的协议：  
（1） DNS：用于域名解析服务，将域名地址转换为 IP 地址。DNS 用的是 53 号端口。  
（2） SNMP：简单网络管理协议，使用 161 号端口，是用来管理网络设备的。由于网络设备很多，无连接的服务就体现出其优势。  
（3） TFTP(Trivial File Transfer Protocal)，简单文件传输协议，该协议在熟知端口 69 上使用 UDP 服务。  
